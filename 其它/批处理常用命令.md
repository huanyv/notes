# 常用批处理命令

## 1. 参数

* 程序外部参数用`%1`至`%9 `
* `%0 %1 %2 %3 %4 %5 %6 %7 %8 %9 %*`为命令行传递给批处理的参数
* `%0` 批处理文件本身，包括完整的路径和扩展名
* `%1` 第一个参数
* `%9` 第九个参数
* `%*` 从第一个参数开始的所有参数
* 最多9个参数

### 1.1 参数扩展

* `%~1`     
* `%~f1`    完整的绝对路径
* `%~d1`    盘符
* `%~p1`    没有盘符没有文件名
* `%~n1`    文件名(没有后缀)
* `%~x1`    文件后缀
* `%~s1`    和%~f1一样??
* `%~a1`    文件属性
* `%~t1`    日期
* `%~z1`    大小
* `%~dp1`    没有文件名绝对路径
* `%~nx1`    文件名(有后缀)

### 1.2 特殊参数

* `%~dp0`获取到的是bat文件的路径
* `%cd%`获取到的是当前[cmd](https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020)窗口的路径

## 2. 命令

* `@echo off`从当前命令开始，关闭所有命令回显

```bat
@echo off
java -jar %~dp0%~n0.jar %cd% %*

REM %~dp0 脚本文件所在目录
REM %~n0 脚本文件去掉后缀
REM %cd% 当前目录
REM %* 所有命令
```

```bash
DIR=$(cd $(dirname $0); pwd)

java -jar $DIR/$(basename $0).jar $(pwd) $*
```

### 2.1 Maven关闭回显加定屏

```shell
@ECHO off

CALL mvn install -D skipTests

PAUSE
```

## 3. 复制

### 3.1 递归复制

```shell
robocopy "源文件夹路径" "目标文件夹路径" /E

robocopy . build /E /XD "%CD%\build" # 当前目录复制到build，但排除build本身
```

## 4. 启动

* 判断CMD启动还是双击启动儿判断使用不使用PUASE

```shell
if xxxx (
	GOTO OVER
)

# 其他逻辑

:OVER
echo %CMDCMDLINE% | find "/c" >nul
if %errorlevel% equ 0  (
	pause
)
```

## 5. Java打包

```shell
@echo off

java -version
if %ERRORLEVEL% neq 0 (
	goto OVER
) 

set warname=name.war

if exist %warname% (
	del %warname%
)

if not exist "build" (
	mkdir "build"
)

del /s /q build

robocopy . build /E /XD "%CD%\build"

cd build

del /s /q package.bat
jar -cvf %warname% *

cd ..
copy build\%warname% .
del /s /q build
rmdir build

echo ===============================
echo Package Success!
echo ===============================

:OVER
echo %CMDCMDLINE% | find "/c" >nul
if %errorlevel% equ 0  (
	pause
)
```